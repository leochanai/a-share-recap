---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import ReportCard from '../components/ReportCard.astro';

const reports = (await getCollection('reports'))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<BaseLayout title="A股每日复盘">
  <!-- Hero Section -->
  <section class="mb-16">
    <div class="mb-8">
      <p class="font-mono text-xs uppercase tracking-widest mb-4" style="color: var(--color-accent);">
        Daily Market Review
      </p>
      <h1 class="font-display text-4xl sm:text-5xl font-semibold leading-tight mb-4" style="color: var(--color-text-primary);">
        A股每日<br/>市场复盘
      </h1>
      <p class="text-lg max-w-xl" style="color: var(--color-text-secondary);">
        专业投资者的每日必读。追踪市场脉搏，洞察资金流向，把握投资先机。
      </p>
    </div>

    <!-- Stats Bar -->
    <div class="flex flex-wrap gap-8 py-6 border-y" style="border-color: var(--color-border);">
      <div>
        <div class="font-mono text-3xl font-medium" style="color: var(--color-accent);">
          {reports.length}
        </div>
        <div class="font-mono text-xs uppercase tracking-widest mt-1" style="color: var(--color-text-muted);">
          份报告
        </div>
      </div>
      {reports.length > 0 && (
        <div>
          <div class="font-mono text-3xl font-medium" style="color: var(--color-text-primary);">
            {reports[0].data.date}
          </div>
          <div class="font-mono text-xs uppercase tracking-widest mt-1" style="color: var(--color-text-muted);">
            最新更新
          </div>
        </div>
      )}
    </div>
  </section>

  <!-- Report List -->
  <section>
    <h2 class="font-mono text-xs uppercase tracking-widest mb-6" style="color: var(--color-text-muted);">
      历史报告 / Archive
    </h2>

    {reports.length === 0 ? (
      <div class="py-16 text-center" style="color: var(--color-text-muted);">
        <p class="font-mono text-sm">暂无复盘报告</p>
      </div>
    ) : (
      <div class="space-y-4">
        {reports.map((report, index) => (
          <div style={`animation-delay: ${index * 0.05}s`} class="animate-fade-in">
            <ReportCard report={report} />
          </div>
        ))}
      </div>
    )}
  </section>
</BaseLayout>
